<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="login-container">
        <img src="logo.png" alt="Logo" class="logo">
        <input type="email" id="username" placeholder="USERNAME" required>
        <input type="password" id="password" placeholder="PASSWORD" required>
        <p class="forgot-password">Forgot password? <a href="#">Contact Admin</a></p>
        <button class="login-button" id="loginButton" type="button">LOG IN</button>
        <p id="error-message"></p>
        <p id="loading-message" style="display:none;">Logging in...</p>
    </div>

    <!-- Firebase and Login Script -->
    <script type="module">
        import { auth } from './firebaseConfig.js';
        import { signInWithEmailAndPassword } from 'firebase/auth';

        // Add event listener to the login button
        document.getElementById('loginButton').addEventListener('click', login);

        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            // Check if the fields are filled
            if (!username || !password) {
                document.getElementById('error-message').textContent = "Please enter both username and password.";
                return;
            }

            // Basic email format validation
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailPattern.test(username)) {
                document.getElementById('error-message').textContent = "Please enter a valid email address.";
                return;
            }

            // Show loading message
            document.getElementById('loading-message').style.display = 'block';

            // Use Firebase Authentication to sign in
            signInWithEmailAndPassword(auth, username, password)
                .then((userCredential) => {
                    // Redirect to dashboard or success page
                    window.location.href = 'index.html'; // Change to your actual dashboard page
                })
                .catch((error) => {
                    let errorMessage;
                    switch (error.code) {
                        case 'auth/invalid-email':
                            errorMessage = "The email address is badly formatted.";
                            break;
                        case 'auth/user-not-found':
                            errorMessage = "No user found with this email.";
                            break;
                        case 'auth/wrong-password':
                            errorMessage = "Incorrect password.";
                            break;
                        default:
                            errorMessage = `Error: ${error.message}`;
                    }
                    document.getElementById('error-message').textContent = errorMessage;
                })
                .finally(() => {
                    // Hide loading message
                    document.getElementById('loading-message').style.display = 'none';
                });
        }

        // Clear error message when the user starts typing again
        document.getElementById('username').addEventListener('input', () => {
            document.getElementById('error-message').textContent = '';
        });
        document.getElementById('password').addEventListener('input', () => {
            document.getElementById('error-message').textContent = '';
        });
    </script>

    <!-- Optional: You can include a build file if you are using a bundler -->
    <!-- <script type="module" src="dist/main.js"></script> -->
</body>
</html>
